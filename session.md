<?php

//md5 the best
//sha(id+app_token+token

Note: let's run over how Sanctum works.

Sanctum uses Laravel's cookie-based session authentication to authenticate users from your client. Here's the flow.

1. You request a CSRF cookie from Sanctum on the client, which allows you to make CSRF-protected requests to normal endpoints like /login.

2. You make a request to the normal Laravel /login endpoint.

3. Laravel issues a cookie holding the user's session. The cookies is generated by the using the random app token as a salt and assigning it to the user_id in one table
 
  We need to be able to query the table/redis and see if the token exists, then assume that the user with that token is the one with the matched user id is the role .
  
    - security concerns - use https cookies! (https or for abitrary data, sessionstorage)
    - maybe store the value as a signed jwt token where the users claims as to his roles are also stored?

    
4. Any requests to your API now include this cookie, so your user is authenticated for the lifetime of that session.

meta.kidlat.xyz
    - can be host/generator of the secure cookie to authenticate across all kidlat sessions (on every request, meta will check token is still valid?)
    - each query validates that the user id is in the table

    
With HMAC, you can achieve authentication and verify that data is correct and authentic with shared secrets, 

